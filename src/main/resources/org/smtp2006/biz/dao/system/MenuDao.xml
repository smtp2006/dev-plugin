<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.smtp2006.biz.dao.system.MenuDao">
	<resultMap id="menuResultMap" type="Menu">
		<id property="id" column="id" />
		<result property="code" column="code" />
		<result property="displayOrder" column="display_order" />

		<result property="isLeaf" column="is_leaf" />
		<result property="isRelative" column="is_relative" />

		<result property="level" column="level" />
		<result property="name" column="name" />
		<result property="parentId" column="parent_id" />
		<result property="role" column="role" />
		<result property="status" column="status" />
		<result property="uri" column="uri" />
		<result property="version" column="version" />
	</resultMap>
	<insert id="create" parameterType="Menu" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO T_SYSTEM_MENU
		(code,
		display_order, is_leaf,
		is_relative, level, name, parent_id, role, status,
		uri, version)
		VALUES
		(#{code}, #{displayOrder},
		#{isLeaf}, #{isRelative}, #{level},
		#{name}, #{parentId}, #{role}, #{status}, #{uri}, #{version})
	</insert>

	<select id="getTopMenusOfUser" parameterType="User">
		SELECT * from T_SYSTEM_MENU
		WHERE (
		role = null or role ='' or role in
		(
		SELECT role from T_AUTH_USER_ROLE
		WHERE
		user_id = #{id}
		)
		)

	</select>
</mapper>
